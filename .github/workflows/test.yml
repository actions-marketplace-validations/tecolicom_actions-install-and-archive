name: test

on:
  push:
    paths-ignore:
      - '**.md'
  pull_request:
  workflow_dispatch:

jobs:
  initial:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: ./
        id: action
        with:
          run: |
            apt-get update
            for pkg in mecab mecab-ipadic-utf8 libmecab-dev
            do
                apt-get install -qq $pkg
            done
          archive: /tmp/apt-archive.tz
          sudo: true
          path: >-
            /etc
            /usr/bin
            /usr/sbin
            /usr/lib
            /usr/share
            /var/lib
      - run: |
          stat \
              /usr/bin/mecab \
              /usr/lib/mecab/mecab-dict-index \
              /etc/alternatives/mecab-dictionary \
              /var/lib/mecab/dic/ipadic-utf8/sys.dic
          tar -tvzf /tmp/apt-archive.tz \
              usr/bin/mecab \
              usr/lib/mecab/mecab-dict-index \
              etc/alternatives/mecab-dictionary \
              var/lib/mecab/dic/ipadic-utf8/sys.dic
